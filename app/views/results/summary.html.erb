<%= render 'top' %>

<% @pipeline = Pipeline.find {|p| p.id == @simulation.pipeline_id} %>
<% @nomination = Nomination.find {|n| n.name == @simulation.nomination_id} %>

<h2>Simulation Average Summary Results - total time: <%= (($timestamp - $initial_timestamp)/3600.0).round(2).to_s %> hours</h2>
<table>
	<thead>
		<tr>
			<th>Station</th>
			<th>Kmp</th>
			<th>Flowrate</th>
			<th>Pumped<br>Volume</th>
			<th>Pressures(kpa):<br>Holding<br>Suction<br>Head<br>Case<br>Discharge</th>
			<th>Bottleneck<br>Percent</th>
			<th>Energy<br>(KwH)</th>
		</tr>
	</thead>
	
	<tbody>
		<% @summary_results.each do |s| %>
		    <% station_id = s.station_id %>
		    <% station = Station.find {|i| i.id == station_id} %>
			<tr>
				<td><%= link_to s.stat, station_detail_result_path(:id => @sim_id, :station_id => s.station_id) %></td>
				<td><%= '%8.2f'% station.kmp %></td>
				<td><%= '%8.1f'% s.flow %></td>
				<td><%= '%10.0f'% s.pumped_volume %></td>
				<td class="top"><%= '%.1f'% s.hold %><br><%= '%.1f'% s.suct %><br><%= '%.1f'% s.head %><br><%= '%.1f'% s.casep %><br><%= '%.1f'% s.disc %></td>
				<td><%= '%-8.1f'% s.bottleneck_pct.round(2) %></td>
				<td><%= '%9.0f'% s.kwh %></td>
			</tr>
		<% end %>
	</tbody>
</table>

<% session.delete :return_to %>
<% session[:return_to] ||= request.path %>
