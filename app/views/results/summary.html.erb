<%= render 'top' %>

<% @pipeline = Pipeline.find {|p| p.id == @simulation.pipeline_id} %>
<% @nomination = Nomination.find {|n| n.name == @simulation.nomination_id} %>

<div id="results">
<h3>Simulation Average Summary Results - total time: <%= (($timestamp - $initial_timestamp)/3600.0).round(2).to_s %> hours</h3>
<table class="table table-bordered table-hover table-condensed">
	<thead>
		<tr>
			<th>Station</th>
			<th>Kmp</th>
			<th>Flowrate</th>
			<th>Pumped<br>Volume</th>
			<th>Holding<br>Pressure</th>
			<th>Suction<br>Pressure</th>
			<th>Head<br>Pressure</th>
			<th>Case<br>Pressure</th>
			<th>Discharge<br>Pressure</th>
			<th>Bottleneck<br>Percent</th>
			<th>Energy<br>(KwH)</th>
		</tr>
	</thead>
	
	<tbody>
		<% @summary_results.each do |s| %>
		    <% station_id = s.station_id %>
		    <% station = Station.find {|i| i.id == station_id} %>
			<tr>
				<td><%= link_to s.stat, station_detail_result_path(:id => @sim_id, :station_id => s.station_id) %></td>
				<td><%= '%8.2f'% station.kmp %></td>
				<td><%= '%8.1f'% s.flow %></td>
				<td><%= number_with_precision(s.pumped_volume, :precision => 0, :delimiter => ',') %></td>
				<td><%= '%.1f'% s.hold %></td>
				<td><%= '%.1f'% s.suct %></td>
				<td><%= '%.1f'% s.head %></td>
				<td><%= '%.1f'% s.casep %></td>
				<td><%= '%.1f'% s.disc %></td>
				<td><%= '%-8.1f'% s.bottleneck_pct.round(2) %></td>
				<td><%= '%9.0f'% s.kwh %></td>
			</tr>
		<% end %>
	</tbody>
</table>
</div>

<% session.delete :return_to %>
<% session[:return_to] ||= request.path %>
