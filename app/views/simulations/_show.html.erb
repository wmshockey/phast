<h2>Simulation</h2>
<table class="table table-bordered table-hover table-condensed">
  <thead>
	<tr>
		<% if current_user.admin? then %>
			<th>User</th>
		<% end %>
	   <th>Name</th>
	   <th>Description</th>
	   <th>Pipeline</th>
	   <th>Nomination</th>
	   <th>Max Flowrate (m3/hr)</th>
	   <th>Max Batchsize (m3)</th>
	   <th>Max Steptime (hrs)</th>
	 </tr>
  </thead>
	<% if current_user.admin? then %>
		<% pipeline = Pipeline.find {|p| p.id == @simulation.pipeline_id} %>
		<% nomination = Nomination.find {|n| n.id == @simulation.nomination_id} %>
	<% else %>
		<% pipeline = current_user.pipelines.find {|p| p.id == @simulation.pipeline_id} %>
		<% nomination = current_user.nominations.find {|n| n.id == @simulation.nomination_id} %>
    <% end %>
  <tbody>
      <tr>
		<% if current_user.admin? then %>
			<td><%= (User.find {|u| u.id == @simulation.user_id}).email %></td>
		<% end %>
        <td><%= link_to @simulation.name, @simulation %></td>
        <td><%= @simulation.description %></td>
		<% if pipeline then %>
        	<td><%= link_to pipeline.name, pipeline %></td>
		<% else %>
			<td><%= "Pipeline missing" %></td>
		<% end %>
		<% if nomination then %>
        	<td><%= link_to nomination.name, nomination %></td>
		<% else %>
			<td><%= "Nomination missing " %></td>
		<% end %>
    <td><%= @simulation.max_flowrate %></td>
    <td><%= @simulation.max_batchsize %></td>
		<td><%= @simulation.max_steptime %></td>
    </tr>
  </tbody>
</table>

<nav class="navbar navbar-default small">
  <div class="container-fluid">
	<ul class="nav navbar-nav">
		<li><%= link_to 'Run Simulation', url_for(action: 'run', controller: 'simulations'), remote: true, :method => :get %> </li>
		<li class="dropdown">
	        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Results<span class="caret"></span></a>
			<ul class="dropdown-menu">
				<li><%= link_to 'Summary Results', summary_result_path(@simulation.id) %> </li>
				<li><%= link_to "Step Details", step_detail_result_path(:id => @simulation.id, :step => 1) %></li>
				<li><%= link_to "Step Linefill", step_linefill_result_path(:id => @simulation.id, :step => 1) %></li>
				<li><%= link_to "Step Flowrates", step_flowrates_result_path(:id => @simulation.id) %><li>
				<li><%= link_to "Station Curves", station_curves_result_path(:id => @simulation.id) %></li>
				<li><%= link_to "Batch Sequence", batch_sequence_result_path(:id => @simulation.id) %></li>
				<li><%= link_to "Power/Energy", power_result_path(:id => @simulation.id) %></li>
			</ul>
		</li>			
		<li><%= link_to 'Edit', edit_simulation_path(@simulation) %> </li>
		<li><%= link_to 'Delete', simulation_path(@simulation.id), method: :delete, data: { confirm: 'Are you sure you want to delete this simulation?' } %> </li>
		<li><%= link_to 'Copy', copy_simulation_path(@simulation.id),  data: {confirm: 'Are you sure you want to make a copy of this simulation?' } %> </li>
		<li><%= link_to 'Back', simulations_path %> </li>
	</ul>
  </div>
</nav>
